

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Quickstart (API) &mdash; CoolBox  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Quickstart (CLI)" href="quick_start_CLI.html" />
    <link rel="prev" title="Installation &amp; Usage" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> CoolBox
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation &amp; Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quickstart (API)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Data-preparation">Data preparation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Testing-dataset">Testing dataset</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Track-is-the-basic-element">Track is the basic element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Track-types">Track types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Other-kinds-of-tracks:">Other kinds of tracks:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#BED-track-:">BED track :</a></li>
<li class="toctree-l4"><a class="reference internal" href="#GTFtrack-:">GTFtrack :</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Hi-C-(.cool)-Track">Hi-C (.cool) Track</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Arcs-Track">Arcs Track</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Compose-Tracks-to-Frame">Compose Tracks to Frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Adjust-Tracks-and-Frame-with-Feature">Adjust Tracks and Frame with Feature</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#with-statement"><code class="docutils literal notranslate"><span class="pre">with</span></code> statement</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Coverage">Coverage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Vertical-lines">Vertical lines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#HighLights">HighLights</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Explore-Genomic-Data-with-coolbox.api.Browser">Explore Genomic Data with <code class="docutils literal notranslate"><span class="pre">coolbox.api.Browser</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#Fetch-precise-data-use-.fetch_data-API">Fetch precise data use <code class="docutils literal notranslate"><span class="pre">.fetch_data</span></code> API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Taken-together">Taken together</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quick_start_CLI.html">Quickstart (CLI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">CoolBox Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_elements.html">Customizing CoolBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CoolBox</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Quickstart (API)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/quick_start_API.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Quickstart-(API)">
<h1>Quickstart (API)<a class="headerlink" href="#Quickstart-(API)" title="Permalink to this headline">¶</a></h1>
<p>This document is for teaching the basic usage of <code class="docutils literal notranslate"><span class="pre">coolbox</span></code> API and explaining some basic conceptions. It is a good starting point for using CoolBox.</p>
<p>Interactive online version: <a class="reference external" href="https://mybinder.org/v2/gh/GangCaoLab/CoolBox/HEAD?filepath=docs%2Fsource%2Fquick_start_API.ipynb">Binder</a></p>
<p>First, let’s import all the components from <code class="docutils literal notranslate"><span class="pre">coolbox.api</span></code>, and check your CoolBox version.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># change working directory</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;../../&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current working directory: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">curdir</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">coolbox</span>
<span class="kn">from</span> <span class="nn">coolbox.api</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">coolbox</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;0.3.0&#39;
</pre></div></div>
</div>
<div class="section" id="Data-preparation">
<h2>Data preparation<a class="headerlink" href="#Data-preparation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Testing-dataset">
<h3>Testing dataset<a class="headerlink" href="#Testing-dataset" title="Permalink to this headline">¶</a></h3>
<p>Here, we use <a class="reference external" href="https://github.com/GangCaoLab/CoolBox/tree/master/tests/test_data">a small testing dataset</a> for convenience. This dataset contains files in differnet file formats, and they are in the same genome range (chr9:4000000-6000000) of the human reference genome (hg19).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>pwd
<span class="o">!</span>ls -lh tests/test_data/
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/Users/bakezq/Desktop/workspace/CoolBox.nosync
total 197152
-rw-r--r--  1 bakezq  staff   787K Dec  6 04:11 bam_chr9_4000000_6000000.bam
-rw-r--r--  1 bakezq  staff   5.8K Jan 16 09:32 bam_chr9_4000000_6000000.bam.bai
-rw-r--r--  1 bakezq  staff   8.5K Dec  6 04:11 bed_chr9_4000000_6000000.bed
-rw-r--r--  1 bakezq  staff   2.2K Jan 16 09:32 bed_chr9_4000000_6000000.bed.bgz
-rw-r--r--  1 bakezq  staff   220B Jan 16 09:32 bed_chr9_4000000_6000000.bed.bgz.tbi
-rw-r--r--  1 bakezq  staff    18K Dec  6 04:11 bedgraph_chr9_4000000_6000000.bg
-rw-r--r--  1 bakezq  staff   264B Dec  6 04:11 bedpe_chr9_4000000_6000000.bedpe
-rw-r--r--  1 bakezq  staff   147B Jan 16 09:14 bedpe_chr9_4000000_6000000.bedpe.bgz
-rw-r--r--  1 bakezq  staff   160B Jan 16 09:14 bedpe_chr9_4000000_6000000.bedpe.bgz.px2
-rw-r--r--  1 bakezq  staff    31K Dec  6 04:11 bigwig_chr9_4000000_6000000.bw
-rw-r--r--  1 bakezq  staff    23M Jan 15 22:08 cool_chr1_89000000_90400000_for_cmp_1.mcool
-rw-r--r--  1 bakezq  staff    23M Jan 15 22:08 cool_chr1_89000000_90400000_for_cmp_2.mcool
-rw-r--r--@ 1 bakezq  staff    26M Dec  6 23:26 cool_chr9_4000000_6000000.mcool
-rw-r--r--  1 bakezq  staff    13M Jan 16 06:07 dothic_chr9_4000000_6000000.hic
-rw-r--r--@ 1 bakezq  staff   9.3M Dec 29 19:24 down100.ctcf.pkl
-rw-r--r--  1 bakezq  staff   535K Dec  6 04:11 gtf_chr9_4000000_6000000.gtf
-rw-r--r--  1 bakezq  staff    28K Jan 16 09:21 gtf_chr9_4000000_6000000.gtf.bgz
-rw-r--r--  1 bakezq  staff   398B Jan 16 09:21 gtf_chr9_4000000_6000000.gtf.bgz.tbi
-rw-r--r--  1 bakezq  staff    32K Dec  6 04:11 hg19_ideogram.txt
-rw-r--r--  1 bakezq  staff   1.9K Dec  6 04:11 human.hg19.genome
-rw-r--r--  1 bakezq  staff   2.1K Dec  6 23:26 make_test_dataset.py
-rw-r--r--  1 bakezq  staff   777B Dec  6 04:11 pairs_chr9_4000000_6000000.pairs
-rw-r--r--  1 bakezq  staff   298B Jan 16 09:14 pairs_chr9_4000000_6000000.pairs.bgz
-rw-r--r--  1 bakezq  staff   258B Jan 16 09:14 pairs_chr9_4000000_6000000.pairs.bgz.px2
-rw-r--r--  1 bakezq  staff   592B Dec  6 04:11 peak_chr9_4000000_6000000.bedpe
-rw-r--r--  1 bakezq  staff   206B Jan 16 09:22 peak_chr9_4000000_6000000.bedpe.bgz
-rw-r--r--  1 bakezq  staff   222B Jan 16 09:22 peak_chr9_4000000_6000000.bedpe.bgz.px2
-rw-r--r--  1 bakezq  staff   765K Dec  6 04:11 snp_chr9_4000000_6000000.snp
-rw-r--r--  1 bakezq  staff   299K Jan 16 09:25 snp_chr9_4000000_6000000.snp.bgz
-rw-r--r--  1 bakezq  staff   1.1K Jan 16 09:25 snp_chr9_4000000_6000000.snp.bgz.tbi
-rw-r--r--  1 bakezq  staff   432B Dec  6 04:11 tad_chr9_4000000_6000000.bed
-rw-r--r--  1 bakezq  staff   153B Jan 16 09:25 tad_chr9_4000000_6000000.bed.bgz
-rw-r--r--  1 bakezq  staff   133B Jan 16 09:25 tad_chr9_4000000_6000000.bed.bgz.tbi
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Here, we define const values for reference files easily later</span>
<span class="n">DATA_DIR</span> <span class="o">=</span> <span class="s2">&quot;tests/test_data&quot;</span>
<span class="n">TEST_RANGE</span> <span class="o">=</span> <span class="s2">&quot;chr9:4000000-6000000&quot;</span>
<span class="n">RANGE_MARK</span> <span class="o">=</span> <span class="s2">&quot;chr9_4000000_6000000&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Track-is-the-basic-element">
<h2>Track is the basic element<a class="headerlink" href="#Track-is-the-basic-element" title="Permalink to this headline">¶</a></h2>
<p>In CoolBox ploting system, “Track” is the basic element. If you have used genome browsers like <a class="reference external" href="https://genome.ucsc.edu/">UCSC Genome Browser</a> or <a class="reference external" href="https://epigenomegateway.wustl.edu/">WashU EpiGenome Browser</a>, you must know what it is.</p>
<p>Basically, “Track” is an image that is related to a piece of continuous region on the reference genome. The most common track is the <code class="docutils literal notranslate"><span class="pre">bigWig</span></code> track, If you have read some papers about epigenomics you must have seen some figures like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bigwig_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> <span class="n">BigWig</span><span class="p">(</span><span class="n">bigwig_path</span><span class="p">)</span>  <span class="c1"># input a file path</span>
<span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>  <span class="c1"># input a genome range</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_9_0.png" src="_images/quick_start_API_9_0.png" />
</div>
</div>
<p>Actually, <code class="docutils literal notranslate"><span class="pre">bigWig</span></code> is just one kind of track. There are other kinds of tracks in CoolBox used to display other kinds of genomic data like long range genome interaction from ChIA-PET and genome contact matrix from Hi-C.</p>
<div class="section" id="Track-types">
<h3>Track types<a class="headerlink" href="#Track-types" title="Permalink to this headline">¶</a></h3>
<p>Now, CoolBox supports the following track types:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Track Type</p></th>
<th class="head"><p>Relevant file format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Track</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Base class for all tracks.</p></td>
</tr>
<tr class="row-odd"><td><p>XAxis</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>X axis of genome.</p></td>
</tr>
<tr class="row-even"><td><p>Spacer</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>For add vertical space between two tracks.</p></td>
</tr>
<tr class="row-odd"><td><p>BAM</p></td>
<td><p><a class="reference external" href="https://samtools.github.io/hts-specs/SAMv1.pdf">.bam</a></p></td>
<td><p>BAM track for visualize the coverage or alignment.</p></td>
</tr>
<tr class="row-even"><td><p>GTF</p></td>
<td><p><a class="reference external" href="https://genome.ucsc.edu/FAQ/FAQformat.html#format4">.gtf</a></p></td>
<td><p>Track of GTF file, for visualize gene annotation.</p></td>
</tr>
<tr class="row-odd"><td><p>HistBase</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Base class for all hist-like tracks.</p></td>
</tr>
<tr class="row-even"><td><p>BigWig</p></td>
<td><p><a class="reference external" href="https://genome.ucsc.edu/goldenPath/help/bigWig.html#:~:text=BigWig%20files%20are%20created%20from,to%20the%20Genome%20Browser%20server.">.bigwig</a></p></td>
<td><p>Track of bigWig file.</p></td>
</tr>
<tr class="row-odd"><td><p>BedGraph</p></td>
<td><p><a class="reference external" href="https://genome.ucsc.edu/goldenPath/help/bedgraph.html">.bedgraph</a></p></td>
<td><p>Track of bedgraph file.</p></td>
</tr>
<tr class="row-even"><td><p>BAMCov</p></td>
<td><p><a class="reference external" href="https://samtools.github.io/hts-specs/SAMv1.pdf">.bam</a></p></td>
<td><p>BAM Coverage track for visualize reads coverage.</p></td>
</tr>
<tr class="row-odd"><td><p>SNP</p></td>
<td><p>.tsv, .vcf</p></td>
<td><p>Track for show SNPs Manhattan plot. Input file is a tab-split file, contain SNP’s chrom, position, pvalue information.</p></td>
</tr>
<tr class="row-even"><td><p>Virtual4C</p></td>
<td><p>.cool, .mcool, .hic</p></td>
<td><p>Virtual 4C track, using Hi-C data to mimic 4C.</p></td>
</tr>
<tr class="row-odd"><td><p>DiScore</p></td>
<td><p>.cool, .mcool, .hic</p></td>
<td><p>Directionality index of Hi-C matrix for detecting TAD.</p></td>
</tr>
<tr class="row-even"><td><p>InsuScore</p></td>
<td><p>.cool, .mcool, .hic</p></td>
<td><p>Insulation score of Hi-C matrix for inferring TAD borders.</p></td>
</tr>
<tr class="row-odd"><td><p>BedBase</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Base class for all bed-like(1d intervals) tracks.</p></td>
</tr>
<tr class="row-even"><td><p>BED</p></td>
<td><p><a class="reference external" href="https://genome.ucsc.edu/FAQ/FAQformat.html#format1">.bed</a></p></td>
<td><p>Track of Bed file, for visualization genome annotation,like refSeq genes and chromatin states or TAD intervals.</p></td>
</tr>
<tr class="row-odd"><td><p>TADCoverage</p></td>
<td><p><a class="reference external" href="https://genome.ucsc.edu/FAQ/FAQformat.html#format1">.bed</a></p></td>
<td><p>Track Coverage for showing TAD(topologically associated domains) upon a HicMat track.</p></td>
</tr>
<tr class="row-even"><td><p>ArcsBase</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Nase class for all bedpe-like(2d contacts/regions) tracks.</p></td>
</tr>
<tr class="row-odd"><td><p>Arcs</p></td>
<td><p>.pairs, .bedpe</p></td>
<td><p>Show the chromosome interactions get from ChIA-PET or Hi-C loop data.</p></td>
</tr>
<tr class="row-even"><td><p>BEDPE</p></td>
<td><p><a class="reference external" href="https://bedtools.readthedocs.io/en/latest/content/general-usage.html#bedpe-format">.bedpe</a></p></td>
<td><p>Same to Arcs, specific to BEDPE file</p></td>
</tr>
<tr class="row-odd"><td><p>Pairs</p></td>
<td><p><a class="reference external" href="https://github.com/4dn-dcic/pairix/blob/master/pairs_format_specification.md">.pairs</a></p></td>
<td><p>Same to Arcs, specific to Pairs file</p></td>
</tr>
<tr class="row-even"><td><p>HiCPeaksCoverage</p></td>
<td><p>.bedpe, .pairs</p></td>
<td><p>HiCPeaks Coverage track for displaying peaks upon a HicMat track.</p></td>
</tr>
<tr class="row-odd"><td><p>HiCMatBase</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Base class for all matrix-like(2d ndarray) tracks.</p></td>
</tr>
<tr class="row-even"><td><p>HiCMat</p></td>
<td><p>.cool, .mcool, .hic</p></td>
<td><p>Show the chromosome contact matrix from Hi-C data.</p></td>
</tr>
<tr class="row-odd"><td><p>Cool</p></td>
<td><p><a class="reference external" href="https://github.com/mirnylab/cooler">.cool, .mcool</a></p></td>
<td><p>Same to HiCMat, specific to cooler’s <code class="docutils literal notranslate"><span class="pre">.cool</span></code> or <code class="docutils literal notranslate"><span class="pre">.mcool</span></code> format.</p></td>
</tr>
<tr class="row-even"><td><p>DotHiC</p></td>
<td><p><a class="reference external" href="https://github.com/aidenlab/juicer/wiki/Data#hic-files">.hic</a></p></td>
<td><p>Same to HiCMat, specific to juicer <code class="docutils literal notranslate"><span class="pre">.hic</span></code> file format.</p></td>
</tr>
<tr class="row-odd"><td><p>HiCDiff</p></td>
<td><p>.cool, .mcool, .hic</p></td>
<td><p>Show the difference between two contact matrix.</p></td>
</tr>
<tr class="row-even"><td><p>Selfish</p></td>
<td><p>.cool, .mcool, .hic</p></td>
<td><p>Show the difference computed by Selfish algorithm between two contact matrix.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="Other-kinds-of-tracks:">
<h3>Other kinds of tracks:<a class="headerlink" href="#Other-kinds-of-tracks:" title="Permalink to this headline">¶</a></h3>
<div class="section" id="BED-track-:">
<h4>BED track :<a class="headerlink" href="#BED-track-:" title="Permalink to this headline">¶</a></h4>
<p>BED track is used to show the genome annotation information like RefSeq or chromatin states. Here, we have the RefSeq data which can be visualized with <code class="docutils literal notranslate"><span class="pre">coolbox.api.BED</span></code>:</p>
<p>Visualizing RefSeq with CoolBox:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> <span class="n">BED</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bed_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bed&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">TrackHeight</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;chr9:4700000-4900000&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[WARNING:plot.py:56 -           plot_genes()] *WARNING* Color set to &#39;bed_rgb&#39;, but bed file does not have the rgb field. The color has been set to #1f78b4
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_14_1.png" src="_images/quick_start_API_14_1.png" />
</div>
</div>
</div>
<div class="section" id="GTFtrack-:">
<h4>GTFtrack :<a class="headerlink" href="#GTFtrack-:" title="Permalink to this headline">¶</a></h4>
<p>GTF track is also used to visualize gene annotations:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> <span class="n">GTF</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/gtf_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.gtf&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">TrackHeight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_16_0.png" src="_images/quick_start_API_16_0.png" />
</div>
</div>
</div>
<div class="section" id="Hi-C-(.cool)-Track">
<h4>Hi-C (.cool) Track<a class="headerlink" href="#Hi-C-(.cool)-Track" title="Permalink to this headline">¶</a></h4>
<p>CoolBox also supports Hi-C data visualization.</p>
<p>CoolBox supports two types of input format for Hi-C matrix data, <a class="reference external" href="https://github.com/GangCaoLab/CoolBox/wiki/Hi-C#cool">.cool</a> and <a class="reference external" href="https://github.com/GangCaoLab/CoolBox/wiki/Hi-C#dothic">.hic</a> file.</p>
<p>Their API is very similar, You can use <code class="docutils literal notranslate"><span class="pre">CoolBox.api.HiCMat</span></code> to visualize both.</p>
<p>Here, we use a <code class="docutils literal notranslate"><span class="pre">.cool</span></code> file as an example.</p>
<div class="section" id="multi-cool(.mcool)-for-multiple-resolution-Hi-C-matrix">
<h5><code class="docutils literal notranslate"><span class="pre">multi-cool(.mcool)</span></code> for multiple resolution Hi-C matrix<a class="headerlink" href="#multi-cool(.mcool)-for-multiple-resolution-Hi-C-matrix" title="Permalink to this headline">¶</a></h5>
<p>Cooler file supports multi-resolution interaction matrix storage (normally file name ends with <code class="docutils literal notranslate"><span class="pre">.mcool</span></code>), this feature allows us take appropriate resolution matrix data depending on the corresponding genome region size, it lets program respond fast when plotting the Hi-C matrix.</p>
<p>The multi-resolution cooler file is recommended. You can use <code class="docutils literal notranslate"><span class="pre">cooler</span> <span class="pre">zoomify</span></code> command to create multi-resolution cooler file from a single resolution cooler file.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> <span class="n">HiCMat</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/cool_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.mcool&quot;</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_19_0.png" src="_images/quick_start_API_19_0.png" />
</div>
</div>
<p>Default Hi-C Track will be plotted in <code class="docutils literal notranslate"><span class="pre">triangular</span></code> style. It also can be plotted in <code class="docutils literal notranslate"><span class="pre">matrix</span></code> or <code class="docutils literal notranslate"><span class="pre">window</span></code> style.</p>
<p>Just specify the <code class="docutils literal notranslate"><span class="pre">style</span></code> parameter, when creating Cool instance, like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> \
    <span class="n">HiCMat</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/cool_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.mcool&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span> <span class="n">color_bar</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_21_0.png" src="_images/quick_start_API_21_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> <span class="n">HiCMat</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/cool_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.mcool&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="n">depth_ratio</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;chr9:4500000-5500000&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_22_0.png" src="_images/quick_start_API_22_0.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Cool</span></code> shows balanced matrix as default, if you want to show the unbalanced matrix, you can set as:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> <span class="n">HiCMat</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/cool_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.mcool&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="n">depth_ratio</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">balance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">+</span> <span class="n">MinValue</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;chr9:4500000-5500000&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_24_0.png" src="_images/quick_start_API_24_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Arcs-Track">
<h4>Arcs Track<a class="headerlink" href="#Arcs-Track" title="Permalink to this headline">¶</a></h4>
<p>Technologies like ChIA-PET or HiChIP can produce many long-range genome-wide chromatin interactions.</p>
<p>And, sometimes, the Hi-C contact matrix contains too much information than needed. When we only need some of the most important interactions from it, we can use some tools like <a class="reference external" href="https://github.com/theaidenlab/juicer/wiki/HiCCUPS">HICCUPS</a> to call the most significant interactions, or “peaks” from the contact matrix.</p>
<p>In either case, Arcs Track can be used to visulize the data. Arcs track accepts <code class="docutils literal notranslate"><span class="pre">.pairs</span></code> or <code class="docutils literal notranslate"><span class="pre">.bedpe</span></code> format:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># BEDPE</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> <span class="n">Arcs</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bedpe_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bedpe&quot;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_26_0.png" src="_images/quick_start_API_26_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Pairs</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> <span class="n">Arcs</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/pairs_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.pairs&quot;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;chr9:4500000-5000000&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_27_0.png" src="_images/quick_start_API_27_0.png" />
</div>
</div>
</div>
</div>
</div>
<div class="section" id="Compose-Tracks-to-Frame">
<h2>Compose Tracks to Frame<a class="headerlink" href="#Compose-Tracks-to-Frame" title="Permalink to this headline">¶</a></h2>
<p>In CoolBox you can compose tracks with “+” operator, as shown above, compose <code class="docutils literal notranslate"><span class="pre">XAxis</span></code> track and a <code class="docutils literal notranslate"><span class="pre">bigwig</span></code> track to a frame object:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>frame = XAxis() + BigWig(&quot;data/K562_RNASeq.bigWig&quot;)
</pre></div>
</div>
<p>Frame is a higher level object and it denotes a set of related tracks. We can use a long “+” expression to compose a complex Frame.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cool1</span> <span class="o">=</span> <span class="n">Cool</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/cool_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.mcool&quot;</span><span class="p">)</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> \
    <span class="n">cool1</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Hi-C(.cool)&quot;</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Virtual4C</span><span class="p">(</span><span class="n">cool1</span><span class="p">,</span> <span class="s2">&quot;chr9:4986000-4986000&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Virtual4C&quot;</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">BAMCov</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bam_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bam&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;BAM Coverage&quot;</span><span class="p">)</span> <span class="o">+</span>\
    <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Arcs</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bedpe_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bedpe&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Inverted</span><span class="p">()</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Arcs(BEDPE)&quot;</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Arcs</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/pairs_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.pairs&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Inverted</span><span class="p">()</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Arcs(Pairs)&quot;</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">GTF</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/gtf_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.gtf&quot;</span><span class="p">,</span> <span class="n">length_ratio_thresh</span><span class="o">=</span><span class="mf">0.005</span><span class="p">)</span> <span class="o">+</span> <span class="n">TrackHeight</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;GTF Annotation&quot;</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;BigWig&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_30_0.png" src="_images/quick_start_API_30_0.png" />
</div>
</div>
</div>
<div class="section" id="Adjust-Tracks-and-Frame-with-Feature">
<h2>Adjust Tracks and Frame with Feature<a class="headerlink" href="#Adjust-Tracks-and-Frame-with-Feature" title="Permalink to this headline">¶</a></h2>
<p>Maybe you have noticed that, in the complex expression above, there are some elements which added with Tracks is not a Track, for example, the <code class="docutils literal notranslate"><span class="pre">TrackHeight</span></code>, <code class="docutils literal notranslate"><span class="pre">Title</span></code> and <code class="docutils literal notranslate"><span class="pre">Title</span></code>.</p>
<p>These elements are <code class="docutils literal notranslate"><span class="pre">Feature</span></code> and they represent the features of the Track.</p>
<p>For example, we set the color and track height feature of a <code class="docutils literal notranslate"><span class="pre">bigWig</span></code> track.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> \
        <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">Color</span><span class="p">(</span><span class="s2">&quot;#ce00ce&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">TrackHeight</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_33_0.png" src="_images/quick_start_API_33_0.png" />
</div>
</div>
<p>And we can adjust the min value and max value of the track:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> \
        <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">Color</span><span class="p">(</span><span class="s2">&quot;#ce00ce&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">TrackHeight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">MinValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">MaxValue</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_36_0.png" src="_images/quick_start_API_36_0.png" />
</div>
</div>
<div class="section" id="with-statement">
<h3><code class="docutils literal notranslate"><span class="pre">with</span></code> statement<a class="headerlink" href="#with-statement" title="Permalink to this headline">¶</a></h3>
<p>By the way, there are one useful trick, you can use Feature with “<code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">statement</span></code>”, like:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">Color</span><span class="p">(</span><span class="s2">&quot;#fd9c6b&quot;</span><span class="p">):</span>
    <span class="n">frame1</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span>\
             <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span>\
             <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span>  <span class="o">+</span>\
             <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">Color</span><span class="p">(</span><span class="s2">&quot;#66ccff&quot;</span><span class="p">):</span>
    <span class="n">frame2</span> <span class="o">=</span> <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span>\
             <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">frame1</span> <span class="o">+</span> <span class="n">frame2</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_39_0.png" src="_images/quick_start_API_39_0.png" />
</div>
</div>
<p>As shown above, any tracks created inside the “<code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">statement</span></code>” will have the specified feature.</p>
<p>Using this trick, we can simplify the complex expression:</p>
</div>
</div>
<div class="section" id="Coverage">
<h2>Coverage<a class="headerlink" href="#Coverage" title="Permalink to this headline">¶</a></h2>
<p>Sometimes we need to draw some graphics above the original figure, for example, the vertical lines and highlight regions. CoolBox has another kinds of element, the <code class="docutils literal notranslate"><span class="pre">Coverage</span></code>. We can add coverage with track, after added to track, coverage will be plotted above the track when the track is plotted.</p>
<div class="section" id="Vertical-lines">
<h3>Vertical lines<a class="headerlink" href="#Vertical-lines" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">locus</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;chr9&quot;</span><span class="p">,</span> <span class="mi">4500000</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;chr9&quot;</span><span class="p">,</span> <span class="mi">5000000</span><span class="p">)]</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Vlines</span><span class="p">(</span><span class="n">locus</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_44_0.png" src="_images/quick_start_API_44_0.png" />
</div>
</div>
<p>Like the <code class="docutils literal notranslate"><span class="pre">Feature</span></code> if you want a set of tracks with same coverge, you can use the “<code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">statement</span></code>”:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">Vlines</span><span class="p">(</span><span class="n">locus</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span>\
            <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span>\
            <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> <span class="n">frame</span> <span class="o">+</span> <span class="n">XAxis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_47_0.png" src="_images/quick_start_API_47_0.png" />
</div>
</div>
<p>Or, you can also use <code class="docutils literal notranslate"><span class="pre">*</span></code> operator do this:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span>\
        <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span>\
        <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span> <span class="o">*</span> <span class="n">Vlines</span><span class="p">(</span><span class="n">locus</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> <span class="n">frame</span> <span class="o">+</span> <span class="n">XAxis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_50_0.png" src="_images/quick_start_API_50_0.png" />
</div>
</div>
</div>
<div class="section" id="HighLights">
<h3>HighLights<a class="headerlink" href="#HighLights" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">regions</span><span class="o">=</span> <span class="p">[</span><span class="s2">&quot;chr9:4600000-5000000&quot;</span><span class="p">,</span> <span class="s2">&quot;chr9:5750000-5950000&quot;</span><span class="p">]</span>

<span class="n">highlights</span> <span class="o">=</span> <span class="n">HighLights</span><span class="p">(</span><span class="n">regions</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="k">with</span> <span class="n">highlights</span><span class="p">,</span> <span class="n">Color</span><span class="p">(</span><span class="s2">&quot;#aa5cff&quot;</span><span class="p">):</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span>\
            <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span>\
            <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> <span class="n">frame</span> <span class="o">+</span> <span class="n">XAxis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_53_0.png" src="_images/quick_start_API_53_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Explore-Genomic-Data-with-coolbox.api.Browser">
<h2>Explore Genomic Data with <code class="docutils literal notranslate"><span class="pre">coolbox.api.Browser</span></code><a class="headerlink" href="#Explore-Genomic-Data-with-coolbox.api.Browser" title="Permalink to this headline">¶</a></h2>
<p>When you want to explore the data, you will change the genome region window very frequently. Under these circumstances, when you want to do the operations like “move right”, “move left”, “zoom in”, “zoom out”, if you use above <code class="docutils literal notranslate"><span class="pre">Frame.plot</span></code> API to plot the figure, you must change parameters and run again. It is tiresome and boring. In order to solve this problem, CoolBox impletmented a simple GUI with <a class="reference external" href="https://ipywidgets.readthedocs.io/">ipywidgets</a>.</p>
<p>You can create a <code class="docutils literal notranslate"><span class="pre">Browser</span></code> instance with a composed frame, and call <code class="docutils literal notranslate"><span class="pre">.show()</span></code> method to show the browser.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cool1</span> <span class="o">=</span> <span class="n">Cool</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/cool_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.mcool&quot;</span><span class="p">)</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> \
    <span class="n">cool1</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Hi-C(.cool)&quot;</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Virtual4C</span><span class="p">(</span><span class="n">cool1</span><span class="p">,</span> <span class="s2">&quot;chr9:4986000-4986000&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Virtual4C&quot;</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">BAM</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bam_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bam&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;BAM Coverage&quot;</span><span class="p">)</span> <span class="o">+</span>\
    <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Arcs</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bedpe_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bedpe&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Inverted</span><span class="p">()</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Arcs(BEDPE)&quot;</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Arcs</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/pairs_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.pairs&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Inverted</span><span class="p">()</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Arcs(Pairs)&quot;</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">GTF</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/gtf_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.gtf&quot;</span><span class="p">,</span> <span class="n">length_ratio_thresh</span><span class="o">=</span><span class="mf">0.005</span><span class="p">)</span> <span class="o">+</span> <span class="n">TrackHeight</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;GTF Annotation&quot;</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">RANGE_MARK</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;BigWig&quot;</span><span class="p">)</span>

<span class="n">bsr</span> <span class="o">=</span> <span class="n">Browser</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="n">bsr</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="n">TEST_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Note: browser is valid only when the jupyter kernel is active</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bsr</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5e0b46d1dfe74b049802251254d432c6", "version_major": 2, "version_minor": 0}</script></div>
</div>
</div>
<div class="section" id="Fetch-precise-data-use-.fetch_data-API">
<h2>Fetch precise data use <code class="docutils literal notranslate"><span class="pre">.fetch_data</span></code> API<a class="headerlink" href="#Fetch-precise-data-use-.fetch_data-API" title="Permalink to this headline">¶</a></h2>
<p>In CoolBox, data and figure are bound together with a single Python object. So, you can fetch precise data of what you see in the figure.</p>
<p>Call the <code class="docutils literal notranslate"><span class="pre">.fetch_data</span></code> method of <code class="docutils literal notranslate"><span class="pre">Browser</span></code> or <code class="docutils literal notranslate"><span class="pre">Frame</span></code>, will return an <code class="docutils literal notranslate"><span class="pre">collection.OrderDict</span></code> which stores many <code class="docutils literal notranslate"><span class="pre">pandas.Dataframe</span></code> objects corresponding to each track in the browser or frame, and the data is only about the current genome region.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bsr</span><span class="o">.</span><span class="n">tracks</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;XAxis.21&#39;, &lt;coolbox.core.track.pseudo.XAxis at 0x7fc1191fbaf0&gt;),
             (&#39;Cool.6&#39;,
              &lt;coolbox.core.track.hicmat.cool.Cool at 0x7fc0ffa16790&gt;),
             (&#39;Spacer.6&#39;,
              &lt;coolbox.core.track.pseudo.Spacer at 0x7fc0ffa16eb0&gt;),
             (&#39;Virtual4C.2&#39;,
              &lt;coolbox.core.track.hist.hicfeature.Virtual4C at 0x7fc0ffa160a0&gt;),
             (&#39;Spacer.7&#39;,
              &lt;coolbox.core.track.pseudo.Spacer at 0x7fc0ffa163d0&gt;),
             (&#39;BAM.1&#39;, &lt;coolbox.core.track.bam.BAM at 0x7fc0ffa164c0&gt;),
             (&#39;Spacer.8&#39;,
              &lt;coolbox.core.track.pseudo.Spacer at 0x7fc0ffa16e50&gt;),
             (&#39;BEDPE.3&#39;,
              &lt;coolbox.core.track.arcs.bedpe.BEDPE at 0x7fc0ffa162b0&gt;),
             (&#39;Spacer.9&#39;,
              &lt;coolbox.core.track.pseudo.Spacer at 0x7fc0ffa16070&gt;),
             (&#39;Pairs.3&#39;,
              &lt;coolbox.core.track.arcs.pairs.Pairs at 0x7fc0ffa166a0&gt;),
             (&#39;GTF.3&#39;, &lt;coolbox.core.track.gtf.GTF at 0x7fc0ffa16e80&gt;),
             (&#39;Spacer.10&#39;,
              &lt;coolbox.core.track.pseudo.Spacer at 0x7fc0ffa16130&gt;),
             (&#39;BigWig.20&#39;,
              &lt;coolbox.core.track.hist.bigwig.BigWig at 0x7fc0ffa160d0&gt;)])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">current_data</span> <span class="o">=</span> <span class="n">bsr</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">list</span><span class="p">(</span><span class="n">current_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;XAxis.21&#39;,
 &#39;Cool.6&#39;,
 &#39;Spacer.6&#39;,
 &#39;Virtual4C.2&#39;,
 &#39;Spacer.7&#39;,
 &#39;BAM.1&#39;,
 &#39;Spacer.8&#39;,
 &#39;BEDPE.3&#39;,
 &#39;Spacer.9&#39;,
 &#39;Pairs.3&#39;,
 &#39;GTF.3&#39;,
 &#39;Spacer.10&#39;,
 &#39;BigWig.20&#39;]
</pre></div></div>
</div>
<p>Data of each track related to the current genome range are stored in this dict:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">current_cool</span> <span class="o">=</span> <span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;Cool.6&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">current_cool</span><span class="p">))</span>
<span class="n">current_cool</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;numpy.ndarray&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(401, 401)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;GTF.3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seqname</th>
      <th>source</th>
      <th>feature</th>
      <th>start</th>
      <th>end</th>
      <th>score</th>
      <th>strand</th>
      <th>frame</th>
      <th>attribute</th>
      <th>gene_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chr9</td>
      <td>protein_coding</td>
      <td>gene</td>
      <td>3824127</td>
      <td>4348392</td>
      <td>.</td>
      <td>-</td>
      <td>.</td>
      <td>gene_id "ENSG00000107249"; gene_name "GLIS3"; ...</td>
      <td>GLIS3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chr9</td>
      <td>protein_coding</td>
      <td>transcript</td>
      <td>3824127</td>
      <td>4152183</td>
      <td>.</td>
      <td>-</td>
      <td>.</td>
      <td>gene_id "ENSG00000107249"; transcript_id "ENST...</td>
      <td>GLIS3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chr9</td>
      <td>protein_coding</td>
      <td>transcript</td>
      <td>3827698</td>
      <td>4299916</td>
      <td>.</td>
      <td>-</td>
      <td>.</td>
      <td>gene_id "ENSG00000107249"; transcript_id "ENST...</td>
      <td>GLIS3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chr9</td>
      <td>retained_intron</td>
      <td>transcript</td>
      <td>3855437</td>
      <td>4118017</td>
      <td>.</td>
      <td>-</td>
      <td>.</td>
      <td>gene_id "ENSG00000107249"; transcript_id "ENST...</td>
      <td>GLIS3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chr9</td>
      <td>processed_transcript</td>
      <td>transcript</td>
      <td>3932360</td>
      <td>4081361</td>
      <td>.</td>
      <td>-</td>
      <td>.</td>
      <td>gene_id "ENSG00000107249"; transcript_id "ENST...</td>
      <td>GLIS3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We can perform some statistics analysis on it. For example, count the distribution of interaction count, etc…</p>
</div>
<div class="section" id="Taken-together">
<h2>Taken together<a class="headerlink" href="#Taken-together" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">DATA_DIR</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;tests/test_data&quot;</span>
<span class="n">test_interval</span> <span class="o">=</span> <span class="s2">&quot;chr9:4000000-6000000&quot;</span>
<span class="n">test_itv</span> <span class="o">=</span> <span class="n">test_interval</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>

<span class="n">cool1</span> <span class="o">=</span> <span class="n">Cool</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/cool_</span><span class="si">{</span><span class="n">test_itv</span><span class="si">}</span><span class="s2">.mcool&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;JuiceBoxLike&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="n">color_bar</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">TrackHeight</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">XAxis</span><span class="p">()</span> <span class="o">+</span> \
        <span class="n">cool1</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Hi-C(.cool)&quot;</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">TADCoverage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/tad_</span><span class="si">{</span><span class="n">test_itv</span><span class="si">}</span><span class="s2">.bed&quot;</span><span class="p">,</span> <span class="n">border_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;HIC with TADs&quot;</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">BED</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/tad_</span><span class="si">{</span><span class="n">test_itv</span><span class="si">}</span><span class="s2">.bed&quot;</span><span class="p">,</span> <span class="n">border_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;TADs&quot;</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">DiScore</span><span class="p">(</span><span class="n">cool1</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span> <span class="o">+</span> <span class="n">Feature</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Directionality index&quot;</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">InsuScore</span><span class="p">(</span><span class="n">cool1</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Insulation score&quot;</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">Virtual4C</span><span class="p">(</span><span class="n">cool1</span><span class="p">,</span> <span class="s2">&quot;chr9:4986000-4986000&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Virtual4C&quot;</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">BAMCov</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bam_</span><span class="si">{</span><span class="n">test_itv</span><span class="si">}</span><span class="s2">.bam&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;BAM Coverage&quot;</span><span class="p">)</span> <span class="o">+</span>\
        <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">Arcs</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bedpe_</span><span class="si">{</span><span class="n">test_itv</span><span class="si">}</span><span class="s2">.bedpe&quot;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Arcs(BEDPE)&quot;</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">Arcs</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/pairs_</span><span class="si">{</span><span class="n">test_itv</span><span class="si">}</span><span class="s2">.pairs&quot;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span> <span class="o">+</span> <span class="n">Inverted</span><span class="p">()</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Arcs(Pairs)&quot;</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">GTF</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/gtf_</span><span class="si">{</span><span class="n">test_itv</span><span class="si">}</span><span class="s2">.gtf&quot;</span><span class="p">,</span> <span class="n">length_ratio_thresh</span><span class="o">=</span><span class="mf">0.005</span><span class="p">)</span> <span class="o">+</span> <span class="n">TrackHeight</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;GTF Annotation&quot;</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">BigWig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bigwig_</span><span class="si">{</span><span class="n">test_itv</span><span class="si">}</span><span class="s2">.bw&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;BigWig&quot;</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">BedGraph</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bedgraph_</span><span class="si">{</span><span class="n">test_itv</span><span class="si">}</span><span class="s2">.bg&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;BedGraph&quot;</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">Spacer</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> \
        <span class="n">BED</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s2">/bed_</span><span class="si">{</span><span class="n">test_itv</span><span class="si">}</span><span class="s2">.bed&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Feature</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;BED Annotation&quot;</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">45</span>
<span class="n">frame</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="n">test_interval</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[WARNING:plot.py:56 -           plot_genes()] *WARNING* Color set to &#39;bed_rgb&#39;, but bed file does not have the rgb field. The color has been set to #1f78b4
[WARNING:plot.py:56 -           plot_genes()] *WARNING* Color set to &#39;bed_rgb&#39;, but bed file does not have the rgb field. The color has been set to #1f78b4
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_API_68_1.png" src="_images/quick_start_API_68_1.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="quick_start_CLI.html" class="btn btn-neutral float-right" title="Quickstart (CLI)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation &amp; Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, WeizeXu.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>